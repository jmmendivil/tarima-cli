#!/usr/bin/env node

var run = require('./'),
    path = require('path');

var pwd = process.cwd();

run({
  src: path.join(pwd, 'src'),
  dest: path.join(pwd, 'dest/build'),
  cache: path.join(pwd, 'dest/index.json'),
  watch: process.argv.indexOf('--watch') > -1,
  ignore: ['!**/_*', '!**/_*/**'],
  bundle: /index|main/,
  filter: function(partial) {
    if (partial.ext === 'coffee') {
      partial.parts.unshift('js');
      partial.ext = 'js';
    }

    if (partial.ext === 'less') {
      partial.parts.unshift('css');
      partial.ext = 'css';
    }

    if (partial.ext === 'jade') {
      partial.parts.unshift('html');
      partial.ext = 'html';
    }
  }
}, function(err, result) {
  if (err) {
    console.log(err);
  }

  console.log('DONE', result.files);
});
